<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exploitation des données PMSI au format pmeasyr • dimRactivite</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Exploitation des données PMSI au format pmeasyr">
<meta property="og:description" content="dimRactivite permet la production standirdisée de tableaux de bord et dindicateurs
  utilisés pour le suivi de lactivité des établissements. Le package utilise les données en entrée et sortie
  de genrsa chargées dans R avec le package pmeasyr.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">dimRactivite</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/generation-tableaux-de-bord-pmsi.html">Import des archives GENSRA et génération de tableaux de bord</a>
    </li>
    <li>
      <a href="articles/indicateurs.html">indicateurs</a>
    </li>
    <li>
      <a href="articles/methodes.html">Méthodes</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="dimractivite" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#dimractivite" class="anchor"></a>dimRactivite</h1></div>
<p>L’objectif du package est de standardiser avec pmeasyr l’import dans R des données PMSI pour créer un environement de travail synthétique comprenant plusieurs années et plusieurs établissements. Une fois les données intégrées, des fonctions de générations automatiques de tableaux de bord sont disponibles permettant de suivre l’activté des établissements.</p>
<p>Les fonctions d’imports et d’analyse sont construites sur le principe que chaque établissement produit tous les mois des fichiers de facturation mis en entrée du logiciel ATIH GENRSA utilisé pour transmettre les données PMSI aux tutelles (remontées mensuelles). L’analyse de ces fichiers par GENRSA produit 2 types d’archives (.zip) le in (les fichiers d’entrée) et le out (fichiers préparés pour être envoyés). Le package généralise l’import des fichiers zippés en sortie de GENRSA (in et out) dans un environnement de travail R. Au cours de cet import les RSA et les RUM sont valorisés permettant l’analyse de recettes T2A séjours des établissements.</p>
<p>Des informations complèmentaires non contenues dans les formats officiels peuvent être intégrées, en particulier des informations sur les structures, permettant de générer des tableaux de bord compréhensibles et de décliner le calcul d’indicateurs sur les différents niveaux d’analyse d’un groupe hospitalier.</p>
<div id="installation" class="section level4">
<h4 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h4>
<p>Vous pouvez installer le package directement depuis github:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages("devtools")</span>
devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"24p11/dimRactivite"</span>)</code></pre></div>
</div>
<div id="demos" class="section level4">
<h4 class="hasAnchor">
<a href="#demos" class="anchor"></a>Démos</h4>
<p>Des scripts de démonstration sont inclus dans le package afin de montrer l’utilisation des différentes fonctions :</p>
<pre><code>+ demos
  +--- import_pmeasyr.R
  +--- generation_tableaux_de_bord.R</code></pre>
<p>Un scénario complet d’import et de génération peut être trouvé dans la vignette <a href="https://24p11.github.io/dimRactivite/articles/generation-tableaux-de-bord-pmsi.html">Génération de tableaux de bord PMSI avec pmeasyr</a> .</p>
</div>
<div id="organisation-du-file-system" class="section level2">
<h2 class="hasAnchor">
<a href="#organisation-du-file-system" class="anchor"></a>Organisation du file system</h2>
<p>Comme préconisé par G.Pressiat dans la documentation du package pmeasyr <a href="https://guillaumepressiat.github.io/pmeasyr/archives.html">les archives PMSI</a>, dimRactivite utilisera un dossier unique comprenant l’ensemble des fichiers zippés en entrée et en sortie de GENRSA pour le MCO. Les fichiers contenus dans ce dossier seront analysés, un fichier .RData par remontée et par établissement sera crée s’il n’existe pas encore, puis les données seront automatiquement chargées dans R à partir des fichiers .RData (par défaut la remontée la plus récente est prise en compte).</p>
<p>L’adresse de ce dossier est renseigné dans l’option du fichier de configuration <code>path</code> .</p>
</div>
<div id="import-des-donnees-pmsi" class="section level2">
<h2 class="hasAnchor">
<a href="#import-des-donnees-pmsi" class="anchor"></a>Import des données PMSI</h2>
<p>Cette procédure, qui procède par plusieurs étapes, utilise les fichiers GENRSA avec les fonctions d’imports pmeasyr (cf <a href="https://guillaumepressiat.github.io/pmeasyr/import-des-donnees.html#rsa">doc irsa</a>):</p>
<ul>
<li>in
<ul>
<li>rss (pmeasyr::irum type 4, transposition des diagnostics, intégration du tra avec pmeasyr::inner_tra)</li>
</ul>
</li>
<li>out
<ul>
<li>rsa (pmeasyr::irsa type 3, intégration du tra avec pmeasyr::inner_tra)</li>
<li>tra</li>
<li>ano (sauvegardé sous la forme vano avec données de valorisation)</li>
<li>ium</li>
<li>diap</li>
<li>porg</li>
<li>pie</li>
</ul>
</li>
</ul>
<p>La procédure réalise ensuite des opérations de transformation et de valorisation :</p>
<ul>
<li>intégration du tra (cf <a href="https://im-aphp.github.io/pmeasyr/reference/inner_tra.html"><code>inner_tra</code></a>)</li>
<li>ajout au rum des variables de fichier ium et de typologies des autorisations,</li>
<li>valorisation des rsa ,</li>
<li>valorisation des rum (cf fonction <a href="https://24p11.github.io/dimRactivite/reference/vvr_rum_repa.html"><code>vvr_rum_repa</code></a>)</li>
<li>ajout des données de facturation à l’ano (vvr_ano_mco)</li>
</ul>
<p>Ces fonctions font appel aux données de référentiels suivantes (disponibles dans les packages <strong><em>nomensland</em></strong> et <strong><em>referentiels</em></strong>) ou dans les tableaux de données de dimRactive:</p>
<ul>
<li>
<code>nomenclature_uma</code> (dimRactivite)</li>
<li>
<code>tarifs_mco_ghs</code> (nomensland)</li>
<li>
<code>tarifs_mco_supplements</code> (nomensland)</li>
</ul>
<p>En complément, on calcule également les différents éléments de valorisation avec les tarifs de l’année antérieure peremttant de suivre l’impact du changement de version de tarifs sur la valorisation.</p>
<p>Au moment de l’import des données dans l’environement de travail (cf fonction <code><a href="reference/load_RData.html">load_RData()</a></code>) on peut également importer les données de l’année n-1 produite à mois de la remontée (version non consolidées des données à n-1).</p>
<p>Pour plus d’information sur les données importées et les variables calculées vous pouvez vous reporter à la partie <a href="https://24p11.github.io/dimRactivite/articles/methodes.html">Méthodes</a> de la documentation du package</p>
<p>A la suite de ces imports des informations complémentaires peuvent être nécessaires pour analyser les données et en particulier des informations descriptives des UMA permettant de les nommer et de les rattacher aux structures de l’établissement. Nous proposons l’utilisation d’un fichier xlsx comprenant comprenant les nom de colonnes suivants :</p>
<ul>
<li>nofiness : numéro nofiness</li>
<li>hopital : nom de l’hopital</li>
<li>pole : nom du pôle</li>
<li>service : nom du service</li>
<li>libelle : om de l’UMA</li>
<li>cdurm : numéro de l’UMA (= nom de la variable UMA dans pmeasyr)</li>
</ul>
<p>D’autres niveaux de regroupement peuvent être ajoutés qui pourront être utilisés avec les fonctions du package.</p>
</div>
<div id="generation-des-tableaux-de-bord" class="section level2">
<h2 class="hasAnchor">
<a href="#generation-des-tableaux-de-bord" class="anchor"></a>Génération des tableaux de bord</h2>
<p>NB : les lien donnés ici ne sont accéssibles que sur l’intranet de l’APHP. Des exemples sous form de fichier xls sont fournis dans les dossiers <code>demos</code> et <code>vignettes</code> .</p>
<p>Ces tableaux permettent de suivre précisément les données d’activité pour chaque niveau de la structure du groupe ou de l’établissement. Il reposent donc beaucoup sur le fichier stucture qui est intégré à la fin des imports et qui permet de décrire selon plusieurs niveaux de regroupements les uma.</p>
<p>On distingue un permier ensemble de tableaux de bord permettant de suivre l’évolution anuelle d’un seul indicateur sur l’ensemble des niveaux de structure, en prenant toujours le principe de distinguer hopsitalisation complète et hospitalisation partielle. On dispose de tableaux de suivi de l’activité (ex : <a href="http://msi.sls.aphp.fr/tdb/index.php?_tbl=TableauDeBordGeneral&amp;_mois=07&amp;_annee=2019&amp;_type=mens">Tableau De Bord General</a> ), des recettes avec une répartition par service (ex : <a href="http://msi.sls.aphp.fr/tdb/index.php?_tbl=TableauDeBordValorisation&amp;_mois=07&amp;_annee=2019&amp;_type=mens">Tableau De Bord Valorisation</a>.</p>
<p>Un autre ensemble de tableaux permet de suivre l’évolution annuelle pour chaque niveau (groupe hospitalier, établissement, pole, service,…) d’un ensemble d’indicateurs. Le package permet de le calcul d’environ 200 indicateurs répartis dans tableaux de bord thématiques (activité, DIM, médical) (ex <a href="http://msi.sls.aphp.fr/tdb/index.php?_tbl=TableauDeBordActivite&amp;_service=Lariboisiere&amp;_mois=07&amp;_annee=2019&amp;_type=mens">Tableau De Bord Activite</a>).</p>
<p>Ces tableaux sont donc produits à partir des données PMSI importées et des informations sur les structures. Pour les tablaux d’activité on utilise un fichier de paramètres afin de lister précisément pour chaque niveau de structure et pour chaque tableau thématique l’ensemble des indicateurs qui devront être calculés. Ce porcessus permet de personnaliser les tableaux de bord en fonction du type d’activité de chaque service ou pôle.</p>
<p>Des fichiers xls de sortie sans aucun formatage sont données à titre indicatif, ils ont été produits par les scripts de démonstration (<code>demos</code>, <code>vignettes</code>) avec des données tirées au sort, et des structures fictives. Ces fichiers peuvent soit être mis en forme avec dans des template xlsx, intégrés par un site web, ou utilisé par une application shiny.</p>
</div>
<div id="parametres" class="section level2">
<h2 class="hasAnchor">
<a href="#parametres" class="anchor"></a>Paramètres</h2>
<p>L’ensemble des paramètres nécessaires au bon fonctionnement du package (chemin des fichiers, nombre d’années d’antériorité pour génération des tableaux de bord, variables du fichier structure,… ) est décrit dans un fichier yaml (un exemple de fichier se trouve dans le dossier demos)</p>
<div id="acces-aux-options" class="section level4">
<h4 class="hasAnchor">
<a href="#acces-aux-options" class="anchor"></a>Accès aux options</h4>
<p>Le package utilise les fonctionnalités offertes par R pour stocker des variables permettant d’exécuter les différentes fonctions (cf documentation R <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/options.html">option settings</a>).</p>
<p>On utilisera ici un fichier au yaml qui sera interprété par la fonction <code>update_option</code> pour mettre à jour les options locales.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">upate_options</span>(<span class="st">"path/to/file"</span>)</code></pre></div>
<p>Les options du package sont accessibles une fois le package installé par la fonction :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/options.html">getOption</a></span>(<span class="st">"dimRactivite.option_name"</span>)</code></pre></div>
<p>où option_name est le nom de l’option.</p>
</div>
<div id="liste-des-options" class="section level4">
<h4 class="hasAnchor">
<a href="#liste-des-options" class="anchor"></a>Liste des options</h4>
<ul>
<li>
<code>path</code> = chemin des vers le dossier contenant les archives PMSI</li>
<li><p><code>path_tdb_files</code> = chemin vers un dossier permettant d’enregistrer les tableaux de bord</p></li>
<li>
<code>extensions</code> = extension des fichiers qui seront reconnus par la fonction <code>scan_path</code>.</li>
<li><p>Valeurs par défaut : rum, rss, rsa, rha, ano, tra, ium, leg, med, medatu, pie, porg, diap</p></li>
<li>
<code>fichiers_imco</code>: liste des types de fichiers nécessaires pour importer une archive</li>
<li>valeurs par défaut :
<ul>
<li>
<code>in</code> : rss</li>
<li>
<code>out</code>: rsa, tra, ano, ium, diap, porg, pie</li>
</ul>
</li>
<li><p><code>services_exclus</code> = liste des services présents dans le fichier structure que l’on souhaite extraire de l’analyse pour les tableaux de bord (fonction <code>get_data</code>)</p></li>
<li><p><code>fichier_structure</code> = chemin vers le fichier structure (au format xlsx) et nom des colonnes. Le fichier doit contenir au moins une colonne cdurm (qui correspond au numéro d’UMA dans la nommenclature <code>pmeasyr</code>) qui permettra le merge avec la table rum. Pour utiliser les tableaux de bord globaux, il sera nécessaire d’avoir également une colonne hopital, pole et service.</p></li>
<li>
<code>gestion_doublons_rum</code> = règle de gestion des doublons pour compter les séjours dans les indicateurs d’activité</li>
<li>valeurs par défaut
<ul>
<li>service: service</li>
<li>pole: service</li>
<li>Centre de Traitement des Brûlés: pole</li>
</ul>
</li>
<li>
<code>profondeur_tdb</code> = profondeur en année par défaut des tableaux de bord.</li>
<li><p>valeur par défaut = 5</p></li>
</ul>
</div>
<div id="fichier-indicateurs" class="section level4">
<h4 class="hasAnchor">
<a href="#fichier-indicateurs" class="anchor"></a>Fichier indicateurs</h4>
<p>Afin de générer les tableaux de bords de suivi d’indicateurs un fichier de paramètrage est utilisé. Le principe est le suivant :</p>
<ul>
<li>la liste de l’ensemble des indicateurs disponibles se trouve en ligne (chaque indicateur est indentifié par une nom unique abrégé), cf <a href="https://24p11.github.io/dimRactivite/articles/indicateurs.html">liste des indicateurs</a>
</li>
<li>les différents niveaux de structure en colonne.</li>
<li>la lettre <code>o</code> est ajoutée à l’intersection pour identifier le fait que tel indicateur doit être calculé</li>
</ul>
<p>Le fichier comprend également une colonne supplémentaire pour décrire les tableaux de bord auxquels appartient chaque indicateur. Un indicateur pouvant appartenir à différents tableaux de bords, il est possible de renseigné plusieurs nom de tableaux de bord séparé par des vigules.</p>
<p>Enfin d’autres variables sont également utilisées.</p>
<p>Au final il comprend les colonnes suivantes</p>
<ul>
<li>niveau : variable numérique de 1 à 4 utilisée pour la mise en forme</li>
<li>libellé de l’indicateur</li>
<li>indentifiant unique de l’indicateur (il n’est pas possible que 2 indicateurs aient le même identifiant)</li>
<li>variables nécessaires au calcul de l’indicateur</li>
<li>liste des tableaux de bord auxquel l’indicateur appartient séparé par des <code>,</code> .</li>
<li>les noms des colonnes suivantes sont liées au fichier strucutre et correspondent aux différents niveaux de l’établissement ou du groupe pour lequel des tableaux de suvis sont nécessaires. On peut également en ajouter de façon indépendante, dans le fichier donné à titre d’exemple un niveau GH a été ajouté qui n’est pas décrit dans le fichier structure.</li>
</ul>
<p>Ce fichier pivot est donc particulièrement sensible et à manier avec précaution. Un fichier exemple pouvant servir de caneva est fourni dans les dossiers <code>demos</code> et <code>vignettes</code> . Les différents scripts permettent de décrire leur utilisation pour produire des données de façon systématique (<code>generation_tableaux_de_bord</code>) ou à la demande (<code>demos/exemple_tableaux_de_bord</code>)</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>DIM APHP.Nord <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by DIM APHP.Nord.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9100.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
